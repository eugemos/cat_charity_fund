# Приложение для Благотворительного фонда
Предоставляет API для создания благотворительных проектов и внесения пожертвований.

В фонде может быть открыто несколько целевых проектов. У каждого проекта есть название, описание и сумма, которую планируется собрать. После того, как нужная сумма собрана, проект закрывается.
Пожертвования в проекты поступают по принципу First In, First Out: все пожертвования идут в проект, открытый раньше других; когда этот проект набирает необходимую сумму и закрывается, пожертвования начинают поступать в следующий проект.

Каждый пользователь может сделать пожертвование и сопроводить его комментарием. Пожертвования не целевые — они вносятся в фонд, а не в конкретный проект. Каждое полученное пожертвование автоматически добавляется в первый открытый проект, который ещё не набрал нужную сумму. Если пожертвование больше нужной суммы или же в фонде нет открытых проектов, оставшиеся деньги ждут открытия следующего проекта. При создании нового проекта все неинвестированные пожертвования автоматически вкладываются в новый проект.

Целевые проекты создаются администраторами сайта. 
Любой пользователь может видеть список всех проектов, включая требуемые и уже внесенные суммы. Это касается всех проектов: и открытых, и закрытых.
Зарегистрированные пользователи могут отправлять пожертвования и просматривать список своих пожертвований.

### Автор
Москалянов Евгений

### Технологии
Python 3.10,
FastAPI 0.78,
SQLAlchemy 1.4,
Alembic 1.7,
Uvicorn 0.17,
SQLite

### Запуск приложения

В ОС Windows предполагается использование gitbash.

Клонировать репозиторий и перейти в него в командной строке:
```
git clone git@github.com:eugemos/cat_charity_fund.git
cd cat_charity_fund
```

Создать и активировать виртуальное окружение:
* в ОС Linux:
```
python3 -m venv venv
source venv/bin/activate
```

* в ОС Windows
```
py -3 -m venv venv
source venv/scripts/activate
```

Обновить утилиту pip:
* в ОС Linux:
```
python3 -m pip install --upgrade pip
```

* в ОС Windows:
```
py -m pip install --upgrade pip
```

Установить зависимости из файла requirements.txt:
```
pip install -r requirements.txt
```

В корне проекта создать файл `.env`, взяв за основу файл `.env.template`.
Все переменные в нём необязательные, за исключением DATABASE_URL.
Значения по-умолчанию, которые будут использованы для незаданных переменных, приведены в файле `.env.template`.

Выполнить миграции:
```
alembic upgrade head
```

Запустить приложение:
```
uvicorn app.main:app
```

Приложение будет доступно на хосте http://127.0.0.1:8000, а по адресу http://127.0.0.1:8000/docs будет находиться интерактивная страница документации API.

### Использование
Адреса эндпойнтов, а также схемы запросов и ответов можно посмотреть на интерактивной странице документации API, расположенной по адресу `/doc`.

Для обращения к API приложения можно использовать утилиту для обмена данными
по протоколу HTTP. Например, **postman** https://www.postman.com

Кроме того, к API можно обращаться прямо на интерактивной странице документации.

Документация к API можно также просматривать с помощью сайта https://redocly.github.io/redoc/ , загрузив на него файл `openapi.json`.

При первом запуске приложения будет создан начальный суперюзер с учётными данными,
заданными в файле `.env`.

Создавать других пользователей можно с помощью эндпойта `/auth/register`.

Сделать другого пользователя суперпользователем может только суперпользователь
с помощью эндпойнта `/users/{id}` (команда PATCH).

